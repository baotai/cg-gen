<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cg.system.mapper.RoleMapper">

    <resultMap id="BaseResultMap" type="com.cg.entity.pojo.system.Role">
        <result column="id" property="id" />
        <result column="role_name" property="roleName" />
        <result column="role_desc" property="desc" />
        <result column="deleted" property="deleted" />
        <result column="cg_created_by" property="cgCreatedBy" />
        <result column="cg_created" property="cgCreated" />
        <result column="cg_modified_by" property="cgModifiedBy" />
        <result column="cg_modified" property="cgModified" />
    </resultMap>

    <!-- 表字段 -->
    <sql id="baseColumns">
         `id`,`role_name`,`role_desc`,`deleted`,`cg_created_by`,`cg_created`,`cg_modified_by`,`cg_modified`
    </sql>

    <select id="findByKeyword" resultMap="BaseResultMap" parameterType="Map">
        select
            <include refid="baseColumns" />
        from `cg_system_roles`
        where
            <if test="paramsMap.keyword != null and paramsMap.keyword != ''">
                `role_name` like concat('%',#{paramsMap.keyword},'%') or
                `role_desc` like concat('%',#{paramsMap.keyword},'%') and
            </if>
            `deleted` = 0
        order by cg_modified desc limit #{paramsMap.startNum}, #{paramsMap.pageSize}
    </select>

    <select id="countRows" resultType="Integer">
        select count(1)
        from `cg_system_roles`
        where
            <if test="paramsMap.keyword != null and paramsMap.keyword != ''">
                `role_name` like concat('%',#{paramsMap.keyword},'%') or
                `role_desc` like concat('%',#{paramsMap.keyword},'%') and
            </if>
            `deleted` = 0
    </select>

    <select id="findByRoleName" resultMap="BaseResultMap" parameterType="Map">
        select
            <include refid="baseColumns" />
        from `cg_system_roles`
        where `role_name` = #{paramsMap.roleName} and `deleted` = 0
    </select>

    <select id="findOne" resultMap="BaseResultMap" parameterType="Map">
        select
            <include refid="baseColumns" />
        from `cg_system_roles`
        where
            <if test="paramsMap.roleName != null and paramsMap.roleName != ''">
                `role_name` = #{paramsMap.roleName} and
            </if>
            <if test="paramsMap.id != null and paramsMap.id != 0">
                `id` = #{paramsMap.id} and
            </if>
           `deleted` = 0 limit 1
    </select>

    <select id="findByIdList" resultMap="BaseResultMap" parameterType="List">
        select
            <include refid="baseColumns" />
        from `cg_system_roles`
        where `id` in
            <foreach collection="list" open="(" close=")" separator="," item="item">
                #{item}
            </foreach>
        and `deleted` = 0
    </select>

    <update id="updateById" parameterType="com.cg.entity.pojo.system.Role">
        update `cg_system_roles` set
            <if test="roleName != null and roleName != ''">
                `role_name` = #{roleName},
            </if>
            <if test="desc != null and desc != ''">
                `role_desc` = #{desc},
            </if>
            <if test="deleted != null">
                `deleted`=#{deleted},
            </if>
            <if test="cgModifiedBy != null and cgModifiedBy != ''">
                `cg_modified_by`=#{cgModifiedBy},
            </if>
            <if test="cgModified != null">
                `cg_modified`=#{cgModified},
            </if>
            `id` = #{id}
        where `id` = #{id} and `deleted` = 0
    </update>

    <insert id="save" parameterType="com.cg.entity.pojo.system.Role">
        insert into
        `cg_system_roles`(`role_name`,`role_desc`,`deleted`,`cg_created_by`,`cg_created`,`cg_modified_by`,`cg_modified`)
        values
        (#{roleName},#{desc},#{deleted},#{cgCreatedBy},#{cgCreated},#{cgModifiedBy},#{cgModified})
    </insert>

</mapper>
